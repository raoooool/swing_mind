# 🎾 Swing Mind - 开发路线图

## 项目目标

构建一个零训练、高性能的网球视频分析核心引擎，提供姿态检测、球追踪、动作分析等功能。

---

## 核心模块

### 1. 姿态检测（Pose Detection）
**技术：** MediaPipe Pose  
**功能：**
- 人体 33 个关键点实时追踪
- 挥拍轨迹提取
- 身体姿态参数（膝盖角度、肩部旋转等）
- 动作分类基础数据

**输出：**
```json
{
  "keypoints": [
    {"id": 0, "name": "nose", "x": 320, "y": 240, "z": 0.1, "visibility": 0.99},
    ...
  ],
  "angles": {
    "right_elbow": 135,
    "right_knee": 145,
    "shoulder_rotation": 45
  }
}
```

---

### 2. 网球追踪（Ball Tracking）
**技术：** OpenCV 颜色检测 + 运动检测  
**功能：**
- 实时球位置检测
- 轨迹追踪
- 速度计算
- 落点预测

**输出：**
```json
{
  "trajectory": [
    {"frame": 0, "x": 100, "y": 200, "visible": true},
    ...
  ],
  "speed": 85.5,  // km/h
  "landing_point": {"x": 450, "y": 380}
}
```

---

### 3. 球场检测（Court Detection）
**技术：** 霍夫变换 + 透视变换  
**功能：**
- 自动检测球场边界
- 建立坐标系统
- 像素坐标 → 真实距离转换
- 判断球是否出界

**输出：**
```json
{
  "court_lines": [...],
  "transform_matrix": [...],
  "real_world_coords": {
    "ball_landing": {"x": 5.2, "y": 8.3}  // 米
  }
}
```

---

### 4. 击球检测（Shot Detection）
**技术：** 碰撞检测 + 球速突变  
**功能：**
- 自动识别击球时刻
- 击球类型分类（正手/反手/发球/截击）
- 视频分段（按击球切分）

**输出：**
```json
{
  "shots": [
    {
      "frame": 125,
      "timestamp": 4.17,
      "type": "forehand",
      "contact_point": {"x": 200, "y": 300}
    },
    ...
  ]
}
```

---

### 5. 动作分类（Action Classification）
**技术：** 基于规则的分类引擎  
**功能：**
- 正手/反手/发球/截击识别
- 动作阶段划分（准备-击球-随挥）
- 动作特征提取

**规则示例：**
- 正手：右手在身体右侧 + 向前挥动
- 反手：右手跨过身体中线 + 向左挥动
- 发球：手臂高举 + 向下挥动

---

### 6. 参数计算（Metrics Calculation）
**技术：** NumPy 几何计算  
**功能：**

**挥拍参数：**
- 挥拍速度（m/s 或 km/h）
- 挥拍角度（度）
- 击球高度（米）
- 随挥距离（米）

**身体参数：**
- 膝盖弯曲角度
- 重心转移
- 肩部旋转角度
- 步法移动距离

**球的参数：**
- 球速（击球前后）
- 旋转估算（通过轨迹曲率）
- 落点精度
- 飞行时间

**输出：**
```json
{
  "swing_speed": 120,  // km/h
  "swing_angle": 45,
  "contact_height": 1.2,  // 米
  "knee_angle": 135,
  "ball_speed_before": 60,
  "ball_speed_after": 85
}
```

---

### 7. 质量评分（Quality Scoring）
**技术：** 规则引擎 + 标准动作对比  
**功能：**
- 动作质量评分（0-100）
- 各维度评分（姿态、击球点、随挥等）
- 改进建议

**输出：**
```json
{
  "overall_score": 78,
  "breakdown": {
    "posture": 85,
    "contact_point": 70,
    "follow_through": 80
  },
  "suggestions": [
    "击球点可以再高一点",
    "随挥动作不够完整"
  ]
}
```

---

## 开发计划

### **Phase 1: MVP（当前）**
**时间：** Week 1-2  
**目标：** 基础框架 + 姿态检测

- [x] 项目脚手架搭建
- [ ] MediaPipe 姿态检测集成
- [ ] 视频读取与处理
- [ ] 关键点可视化
- [ ] 基础角度计算
- [ ] 单元测试

**交付物：**
- 可运行的姿态检测 demo
- 输出关键点 JSON
- 可视化标注视频

---

### **Phase 2: 球追踪**
**时间：** Week 3  
**目标：** 网球检测与追踪

- [ ] 颜色检测实现
- [ ] 运动检测实现
- [ ] 轨迹追踪算法
- [ ] 速度计算
- [ ] 击球检测（简单版）

**交付物：**
- 球追踪 demo
- 轨迹可视化
- 速度输出

---

### **Phase 3: 参数计算**
**时间：** Week 4  
**目标：** 基础参数提取

- [ ] 挥拍速度计算
- [ ] 身体角度计算
- [ ] 击球点检测
- [ ] 参数聚合输出

**交付物：**
- 完整的参数 JSON
- 参数可视化

---

### **Phase 4: 球场检测**
**时间：** Week 5  
**目标：** 坐标系统建立

- [ ] 球场线检测
- [ ] 透视变换
- [ ] 坐标转换
- [ ] 出界判断

---

### **Phase 5: 动作分类**
**时间：** Week 6  
**目标：** 动作识别

- [ ] 规则引擎设计
- [ ] 正手/反手分类
- [ ] 发球识别
- [ ] 动作阶段划分

---

### **Phase 6: 质量评分**
**时间：** Week 7+  
**目标：** 专业级分析

- [ ] 评分算法设计
- [ ] 标准动作库
- [ ] 对比算法（DTW）
- [ ] 改进建议生成

---

## 技术选型

| 模块 | 技术 | 原因 | 训练需求 |
|------|------|------|----------|
| 姿态检测 | MediaPipe Pose | 预训练、快速、准确 | ❌ 无需训练 |
| 球追踪 | OpenCV 颜色+运动检测 | 简单、鲁棒、CPU友好 | ❌ 无需训练 |
| 球场检测 | 霍夫变换 | 经典算法、稳定 | ❌ 无需训练 |
| 击球检测 | 碰撞检测 + 规则 | 实时、准确 | ❌ 无需训练 |
| 动作分类 | 规则引擎 | 可解释、易调试 | ❌ 无需训练 |
| 参数计算 | NumPy 几何计算 | 精确、快速 | ❌ 无需训练 |

**核心原则：零训练、全预训练模型 + 传统 CV**

---

## 性能目标

- **处理速度：** 5-10 FPS (CPU) / 20-30 FPS (GPU)
- **内存占用：** < 2GB
- **准确率：**
  - 姿态检测：> 95%
  - 球追踪：> 90%
  - 击球检测：> 85%

---

## 未来扩展

### **高级功能**
- 多角度融合
- 3D 重建
- 实时反馈（< 1秒延迟）
- 对比分析（多球员）

### **统计分析**
- 热力图（移动范围、落点分布）
- 趋势分析（疲劳度、速度衰减）
- 比赛报告生成

### **深度学习增强**
- 训练自定义球拍检测模型
- 动作质量评分模型
- 战术分析

---

## 参考项目

- **ArtLabss/tennis-tracking** - 球追踪参考
- **avivcaspi/TennisProject** - 综合分析参考
- **Google MediaPipe** - 姿态估计
- **TrackNet** - 球追踪论文实现

---

## 当前状态

**版本：** v0.1.0-alpha  
**进度：** Phase 1 - 姿态检测开发中  
**最后更新：** 2026-02-10
